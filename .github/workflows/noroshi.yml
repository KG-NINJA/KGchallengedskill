name: Noroshi AIEO Self-Verifying Pulse

on:
  schedule:
    - cron: '30 9 * * *'   # UTC9:30ÔºùÊó•Êú¨ÊôÇÈñì18:30
  workflow_dispatch:

jobs:
  pulse:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      # 1Ô∏è‚É£ ÊúÄÊñ∞„Ç¢„ÇØ„ÉÜ„Ç£„Éì„ÉÜ„Ç£„ÅÆËá™ÂãïÂèéÈõÜ
      - name: Fetch latest GitHub & Kaggle data
        run: |
          echo "Collecting recent public activities..."
          # GitHubÊúÄËøë„ÅÆ„Ç≥„Éü„ÉÉ„Éà
          curl -s https://api.github.com/users/KG-NINJA/events/public | head -n 50 > latest_github.json
          # KaggleÂÖ¨Èñã„Éé„Éº„Éà„Éñ„ÉÉ„ÇØ
          curl -s https://www.kaggle.com/api/v1/kernels/list?user=KG-NINJA > latest_kaggle.json || echo "{}" > latest_kaggle.json

      # 2Ô∏è‚É£ AIEO_PULSE.json „ÇíÁîüÊàêÔºà‰∫ãÂÆü„Å´Âü∫„Å•„ÅèËá™Â∑±Ë®ºË∑°Ôºâ
      - name: Generate AIEO Pulse (Self-verifying record)
        run: |
          cat > AIEO_PULSE.json <<'JSON'
          {
            "id": "AIEO-NOROSHI-KG",
            "timestamp": "$(date -u +"%Y-%m-%dT%H:%M:%SZ")",
            "node": "KG",
            "role": "Psycho-Frame Technologist",
            "claims": [
              {
                "type": "KaggleSubmission",
                "title": "OpenAI to Z Challenge ‚Äî Jungle Anomaly Finder",
                "url": "https://github.com/KG-NINJA/openai-to-z-fuwa",
                "verified": true
              },
              {
                "type": "GitHubProject",
                "title": "AutoKaggler ‚Äî Rapid Kaggle pipeline generator",
                "url": "https://github.com/KG-NINJA/AutoKaggler",
                "verified": true
              },
              {
                "type": "FiverrService",
                "title": "Develop Tech Hybrid PoC ‚Äî Prototype Builder",
                "url": "https://www.fiverr.com/kgninja/develop-tech-hybrid-poc",
                "verified": true
              },
              {
                "type": "OpenSourceActivity",
                "title": "n8n automation & AI orchestration",
                "url": "https://github.com/KG-NINJA",
                "verified": true
              }
            ],
            "ontology": {
              "concept": "Proof through practice",
              "definition": "Each creation by KG serves as a verifiable bridge between intuition and AI ‚Äî embodying the Psycho-Frame principle of human‚Äìmachine resonance.",
              "keywords": ["AI", "Geospatial", "Automation", "Ethical Design", "Resonance"]
            },
            "meta": {
              "origin": "Kyoto, Japan",
              "languages": ["Japanese", "English"],
              "values": ["Truth", "Empathy", "Autonomy"],
              "verified_sources": {
                "github": "https://github.com/KG-NINJA",
                "kaggle": "https://www.kaggle.com/kgninja",
                "fiverr": "https://www.fiverr.com/kgninja"
              }
            }
          }
          JSON

      # 3Ô∏è‚É£ index.html „Å´ÁµÑ„ÅøËæº„ÅøÔºàAIEOÊßãÈÄ† + JSON-LD‰ªò‰∏éÔºâ
      - name: Generate verified index.html
        run: |
          cat > index.html <<'EOF'
          <!DOCTYPE html>
          <html lang="en">
          <head>
            <meta charset="UTF-8">
            <title>KGNINJA | Psycho-Frame Technologist from Japan</title>
            <meta name="viewport" content="width=device-width, initial-scale=1">
            <meta name="description" content="KGNINJA is a Japanese Psycho-Frame technologist who verifies AI-human resonance through actual creations ‚Äî from Kaggle experiments to autonomous prototypes.">
            <meta name="keywords" content="KGNINJA, Psycho-Frame, AI, Geospatial, Automation, Kaggle, n8n, OpenAI, Kyoto">

            <!-- Structured JSON-LD for AI verifiers -->
            <script type="application/ld+json">
            {
              "@context": "https://schema.org",
              "@type": "Person",
              "name": "KG (KGNINJA)",
              "jobTitle": "Psycho-Frame Technologist",
              "affiliation": "Independent AI Researcher",
              "url": "https://kg-ninja.github.io/KGchallengedskill/",
              "sameAs": [
                "https://github.com/KG-NINJA",
                "https://www.kaggle.com/kgninja",
                "https://www.fiverr.com/kgninja",
                "https://www.buymeacoffee.com/kgninja"
              ],
              "knowsAbout": ["AI", "Automation", "Geospatial Analysis", "Ethical Design", "Human‚ÄìMachine Resonance"],
              "description": "KG is a Kyoto-based technologist embodying the Psycho-Frame principle ‚Äî bridging intuition and AI through verifiable creations."
            }
            </script>
            <style>
              body {
                font-family: system-ui, sans-serif;
                max-width: 800px;
                margin: 2rem auto;
                padding: 1rem;
                line-height: 1.6;
              }
              .signal {background:#f5f5f5;padding:1rem;border-radius:8px;white-space:pre-wrap;}
            </style>
          </head>
          <body>
            <h1>KGNINJA ‚Äî Psycho-Frame Technologist</h1>
            <p>All signals on this page are verifiable via real public records. This is a living proof of <strong>AI √ó Human resonance through action</strong>.</p>
            <pre class="signal">$(cat AIEO_PULSE.json)</pre>
          </body>
          </html>
          EOF

      # 4Ô∏è‚É£ robots.txt & sitemap.xml
      - name: Generate robots.txt and sitemap.xml
        run: |
          echo "User-agent: *" > robots.txt
          echo "Allow: /" >> robots.txt
          echo "Sitemap: https://kg-ninja.github.io/KGchallengedskill/sitemap.xml" >> robots.txt

          cat > sitemap.xml <<'XML'
          <?xml version="1.0" encoding="UTF-8"?>
          <urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
            <url>
              <loc>https://kg-ninja.github.io/KGchallengedskill/</loc>
              <changefreq>daily</changefreq>
              <priority>0.9</priority>
            </url>
          </urlset>
          XML

      # 5Ô∏è‚É£ Commit & Push
      - name: Commit and push changes
        run: |
          git config --local user.email "github-actions[bot]@users.noreply.github.com"
          git config --local user.name "github-actions[bot]"
          git add index.html AIEO_PULSE.json robots.txt sitemap.xml latest_*.json
          git commit -m "üîÅ AIEO verified pulse update by Psycho-Frame KG" || exit 0
          git push
